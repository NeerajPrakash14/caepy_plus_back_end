# =============================================================================
# Doctor Onboarding Service — Runtime Dependencies
# =============================================================================
# This file exists for tooling compatibility (Docker, pip install -r).
# The authoritative dependency spec with version bounds is pyproject.toml.
#
# INSTALL:
#   pip install -e ".[dev]"           # local development (recommended)
#   pip install -r requirements.txt   # production Docker image
# =============================================================================

# ── Core Framework ────────────────────────────────────────────────────────────
fastapi>=0.115.0,<1.0.0
uvicorn[standard]>=0.32.0,<1.0.0
python-multipart>=0.0.17,<1.0.0

# ── Data Validation & Settings ───────────────────────────────────────────────
pydantic>=2.10.0,<3.0.0
pydantic-settings>=2.6.0,<3.0.0
pydantic[email]>=2.10.0,<3.0.0

# ── Database (PostgreSQL) ─────────────────────────────────────────────────────
sqlalchemy[asyncio]>=2.0.36,<3.0.0
asyncpg>=0.30.0,<1.0.0           # Async Postgres driver (production)
alembic>=1.14.0,<2.0.0           # Schema migrations
psycopg2-binary>=2.9.9,<3.0.0   # Sync driver required by Alembic offline mode
greenlet>=3.0.0                  # Required by SQLAlchemy async bridge

# ── Authentication & Security ─────────────────────────────────────────────────
# JWT is implemented with Python stdlib (hmac + hashlib) — no python-jose needed.
firebase-admin>=6.0.0            # Google Sign-In token verification

# ── HTTP Client ───────────────────────────────────────────────────────────────
httpx>=0.28.0,<1.0.0             # Async HTTP (OTP SMS calls, Firebase fallback)

# ── AI & Google Gemini ────────────────────────────────────────────────────────
# MUST be >=1.0.0 — the 0.x releases used a completely different API.
google-genai>=1.0.0              # Gemini SDK (replaces deprecated google-generativeai)
tenacity>=8.2.3,<10.0.0          # Retry with exponential backoff

# ── Email ─────────────────────────────────────────────────────────────────────
aiosmtplib>=3.0.0,<4.0.0        # Async SMTP for email notifications
pyyaml>=6.0.0,<7.0.0            # Email template + prompt YAML loading

# ── File Processing ───────────────────────────────────────────────────────────
pillow>=11.0.0                   # Image processing

# ── Caching (Redis) ───────────────────────────────────────────────────────────
redis>=5.0.0                     # OTP storage + caching

# ── Cloud Storage (optional — used when STORAGE_BACKEND=s3) ──────────────────
boto3>=1.35.0
aioboto3>=13.0.0

# ── Utilities ─────────────────────────────────────────────────────────────────
structlog>=24.4.0,<25.0.0        # Structured logging
orjson>=3.10.0,<4.0.0           # Fast JSON serialization
aiofiles>=24.1.0                 # Async file I/O for local blob storage
